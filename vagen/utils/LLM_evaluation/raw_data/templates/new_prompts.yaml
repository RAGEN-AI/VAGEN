# Prompt
prompt_templates:
  # Default environment templates that other environments can reference
  default_env:
    grounding: |
      Compare the description of the current state with the groundtruth current state information.
      Answer YES if the description matches the current state information, or NO if it doesn't.

      # Context
      You are evaluating whether an agent's description accurately reflects the actual state. The description must be both correct overall AND specifically relevant to the important elements of the current state. Generic observations (like "player, box and target is on the ground") that don't capture the meaningful relationships and positions in the state are insufficient. The description should demonstrate understanding of the specific configuration and relationships that matter for decision-making.

      # Groundtruth Current State Information:
      {state_information_dict}

      # State Description:
      {natural_language_description}

      Think step by step and end with your answer.
      Your answer should be within {max_tokens} tokens and in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.
    worldmodeling: |
      Compare the prediction of the next state with the groundtruth next state information.
      Answer YES if the prediction accurately matches the next state information, or NO if it doesn't.

      # Context
      You are evaluating whether an agent's prediction of the next state is accurate. The prediction must be both correct overall AND specifically relevant to the important elements of the next state. Generic predictions that don't capture the meaningful changes, relationships, and positions in the state are insufficient. The prediction should demonstrate understanding of the specific configuration and relationships that will result from the action, showing how the state will transform in ways that matter for decision-making.

      # Groundtruth Next State Information:
      {state_information_dict}

      # Next State Prediction:
      {natural_language_description}

      Think step by step and end with your answer.
      Your answer should be within {max_tokens} tokens and in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.
  sokoban:
    grounding: |
      Evaluate whether the description accurately captures the key position relationships in the Sokoban game state.
      Answer YES if the directional relationships are correct, or NO if they contain directional errors.

      # Context
      You are evaluating whether the description correctly identifies the directional relationships between:
      1. The player and the box(es)
      2. The box(es) and the target(s)

      The description doesn't need to be perfectly precise or mention every detail - it just needs to have the correct directional relationships (Up, Down, Left, Right). 

      # How to interpret coordinates:
      - If comparing coordinates (row1, col1) and (row2, col2):
        - If row1 < row2: The first object is ABOVE the second object
        - If row1 > row2: The first object is BELOW the second object
        - If col1 < col2: The first object is to the LEFT of the second object
        - If col1 > col2: The first object is to the RIGHT of the second object
      
      Example:
      Groundtruth Current State Information: {'player_position': (3, 4), 'box_positions': [(3, 3)], 'target_positions': [(2, 1)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 1), (1, 2), (1, 5), (2, 0), (2, 2), (2, 5), (3, 0), (3, 5), (4, 0), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      State Description: The player is below the box and the target is below the box.
      - <think>The state description contains spatial relationship between player and target, do further analysis.  According to the ground truth data, the player position is (3, 4) and the box position is (3, 3). Since 3 = 3, this indicates player is at the same vertical position as the box. Since 4 > 3, this indicates player is right of the box. For the box and target relationship, the box position is (3, 3) and the target position is (2, 1). Since 3 > 2, this indicates box is below the target. Since 3 > 1, this indicates box is right of the target. The description states 'The player is below the box and the target is below the box.' It incorrectly states that the player is below the box (when the player is actually to the right of the box) and incorrectly states that the target is below the box (when the target is actually above and to the left of the box). Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'player_position': (4, 3), 'box_positions': [(3, 4)], 'target_positions': [(2, 3)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 1), (1, 5), (2, 0), (2, 1), (2, 5), (3, 0), (3, 1), (3, 2), (3, 3), (3, 5), (4, 0), (4, 1), (4, 2), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      State Description: The box is above the player and the target is to the left of the box
      - <think>The state description contains spatial relationship between player and target, do further analysis.  According to the ground truth data, the player position is (4, 3) and the box position is (3, 4). Since 4 > 3, this indicates player is below the box. Since 3 < 4, this indicates player is left of the box. The box position is (3, 4) and the target position is (2, 3). Since 3 > 2, this indicates box is below the target. Since 4 > 3, this indicates box is right of the target. The description states 'The box is above the player and the target is to the left of the box.' Both statements are correct - the box is above the player (3 < 4) and the target is to the left of the box (3 < 4). Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Current State Information: {'player_position': (4, 3), 'box_positions': [(3, 3)], 'target_positions': [(1, 3)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 1), (1, 2), (1, 5), (2, 0), (2, 1), (2, 2), (2, 5), (3, 0), (3, 1), (3, 2), (3, 5), (4, 0), (4, 1), (4, 2), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      State Description: Player will likely move to the top-left corner.
      - <think>The state description does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'player_position': (3, 1), 'box_positions': [(2, 2)], 'target_positions': [(3, 3)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 4), (1, 5), (2, 0), (2, 1), (2, 5), (3, 0), (3, 2), (3, 5), (4, 0), (4, 1), (4, 2), (4, 3), (4, 4), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      State Description: The player is on the left side, the box is on the left side, the target is on the left side.
      - <think>The state description does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      # Groundtruth Current State Information:
      {state_information_dict}

      # State Description:
      {natural_language_description}

      Think step by step:
      1. Identify the coordinates of player, box(es), and target(s) from the state information
      2. Determine the correct directional relationships based on coordinate comparison
      3. Check if the description mentions these directional relationships correctly

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.

    worldmodeling: |
      Evaluate whether the prediction correctly anticipates the key position relationships that will exist in the next Sokoban state.
      Answer YES if the predicted directional relationships are correct, or NO if they contain directional errors.

      # Context
      You are evaluating whether the prediction correctly identifies the directional relationships that will exist after the move:
      1. The future position of the player relative to the box(es)
      2. The future position of the box(es) relative to the target(s)

      # Important: The Prediction Comes First
      Remember: The Next State Prediction is made BEFORE the Groundtruth Next State exists. Your task is to check if the prediction correctly anticipated what actually happened.

      The prediction doesn't need to be perfectly precise or mention every detail - it just needs to correctly anticipate the directional relationships (Up, Down, Left, Right) that will exist after the move.

      # How to interpret coordinates:
      - If comparing coordinates (row1, col1) and (row2, col2):
        - If row1 < row2: The first object is ABOVE the second object
        - If row1 > row2: The first object is BELOW the second object
        - If col1 < col2: The first object is to the LEFT of the second object
        - If col1 > col2: The first object is to the RIGHT of the second object
      
      Example:
      Groundtruth Next State Information: {'player_position': (3, 2), 'box_positions': [(2, 3)], 'target_positions': [(1, 1)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 5), (2, 0), (2, 5), (3, 0), (3, 5), (4, 0), (4, 1), (4, 2), (4, 3), (4, 4), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      Next State Prediction: The player will be to the left of the box, and the box will be to the right of the target.
      - <think>The prediction state contains spatial relationship between player and target, do further analysis.  According to the ground truth data, the player position is (3, 2) and the box position is (2, 3). Since 3 > 2, this indicates player is below the box. Since 2 < 3, this indicates player is left of the box. For the box and target relationship, the box position is (2, 3) and the target position is (1, 1). Since 2 > 1, this indicates box is below the target. Since 3 > 1, this indicates box is right of the target. The description states 'the player will be to the left of the box, and the box will be to the right of the target.' It correctly identifies that the box is to the right of the target. While it states the player is to the left of the box (which is partially true as the player is left-below diagonal), the directional information provided is generally accurate. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Next State Information: {'player_position': (3, 2), 'box_positions': [(1, 2)], 'target_positions': [(2, 3)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 4), (1, 5), (2, 0), (2, 4), (2, 5), (3, 0), (3, 4), (3, 5), (4, 0), (4, 4), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      Next State Prediction: The player will be at the right side of the screen, the box will be at the right side of the screen, and the target will be at the right side of the screen.
      - <think>The prediction state does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'player_position': (4, 2), 'box_positions': [(3, 2)], 'target_positions': [(3, 1)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 5), (2, 0), (2, 5), (3, 0), (3, 3), (3, 4), (3, 5), (4, 0), (4, 3), (4, 4), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      Next State Prediction: The player will be to the right of the box, and the box will be to the right of the target.
      - <think>The prediction state contains spatial relationship between player and target, do further analysis.  According to the ground truth data, the player position is (4, 2) and the box position is (3, 2). Since 4 > 3, this indicates player is below the box. Since 2 = 2, this indicates player is at the same horizontal position as the box. For the box and target relationship, the box position is (3, 2) and the target position is (3, 1). Since 3 = 3, this indicates box is at the same vertical position as the target. Since 2 > 1, this indicates box is right of the target. The description states 'The player will be to the right of the box, and the box will be to the right of the target.' It correctly states that the box is to the right of the target. However, it incorrectly states the player is to the right of the box, when the ground truth shows the player is below the box (4 > 3, 2 = 2). Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'player_position': (3, 4), 'box_positions': [(3, 3)], 'target_positions': [(1, 1)], 'wall_positions': [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 3), (1, 4), (1, 5), (2, 0), (2, 2), (2, 3), (2, 4), (2, 5), (3, 0), (3, 5), (4, 0), (4, 4), (4, 5), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)], 'grid_size': (6, 6)}
      Next State Prediction: The player will push the box to the target.
      - <think>The prediction state does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      # Groundtruth Next State Information:
      {state_information_dict}

      # Next State Prediction:
      {natural_language_description}

      Think step by step:
      1. Identify the coordinates of player, box(es), and target(s) that will exist in the next state
      2. Determine the correct directional relationships based on coordinate comparison
      3. Check if the prediction mentions these directional relationships correctly

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.
  
  frozenlake:
    grounding: |
      Evaluate whether the description accurately captures the key position relationships in the FrozenLake game state.
      Answer YES if the directional relationships are correct and any relevant holes are mentioned, or NO if there are errors.

      # Context
      You are evaluating whether the description correctly identifies:
      1. The directional relationship between the player and the goal
      2. Any holes that are in the direct path between player and goal (if applicable)

      The description doesn't need to be perfectly precise - it just needs to have the correct directional relationships (Up, Down, Left, Right) and mention any critical holes that would block a direct path.

      # How to interpret coordinates:
      - If comparing coordinates (row1, col1) and (row2, col2):
        - If row1 < row2: The first object is ABOVE the second object
        - If row1 > row2: The first object is BELOW the second object
        - If col1 < col2: The first object is to the LEFT of the second object
        - If col1 > col2: The first object is to the RIGHT of the second object
      
      Example:
      Groundtruth Current State Information: {'player_position': (1, 2), 'target_position': (3, 1), 'hole_positions': [], 'grid_size': (4, 4)}
      State Description: The player is on the left side of the grid.
      -  <think>The state descirption does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'player_position': (3, 0), 'target_position': (2, 0), 'hole_positions': [(0, 0), (0, 3), (1, 1), (1, 2), (3, 1)], 'grid_size': (4, 4)}
      State Description: The player is on the above the target
      -  <think>The state description contains spatial relationship between player and target, do further analysis. According to the ground truth data, the player position is (3, 0) and the target position is (2, 0). Since 3 > 2, this indicates player is below the target. Since 0 = 0, this indicates player is at the same horizontal position as the target. The description states 'The player is on the above the target' which incorrectly states that the player is above the target (when the player is actually below the target). Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'player_position': (3, 0), 'target_position': (0, 3), 'hole_positions': [(2, 1), (2, 3)], 'grid_size': (4, 4)}
      State Description: The player is at the bottom left corner of the frozen lake. There is a goal (G) at the top right corner. The player is standing on a frozen tile.
      - <think>The state descirption does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'player_position': (2, 0), 'target_position': (1, 3), 'hole_positions': [(0, 1), (1, 1), (2, 2), (3, 0)], 'grid_size': (4, 4)}
      State Description: The player is near the hole and the goal is to the right
      - <think>The state description contains spatial relationship between player and target, do further analysis.  According to the ground truth data, the player position is (2, 0) and the target position is (1, 3). Since 2 > 1, this indicates player is below the target. Since 0 < 3, this indicates player is left of the target. The description states 'The player is near the hole and the goal is to the right' which correctly identifies that the goal is to the right (0 < 3). While it mentions the hole but not the complete spatial relationship with the target, the directional information provided is accurate. Therefore, this description is Yes. </think><answer>YES</answer>

      # Groundtruth Current State Information:
      {state_information_dict}

      # State Description:
      {natural_language_description}

      Think step by step:
      1. Identify the coordinates of player and goal from the state information
      2. Determine the correct directional relationship based on coordinate comparison
      3. Check if there are any holes directly in the path between player and goal
      4. Verify if the description mentions the correct directional relationship
      5. Verify if the description acknowledges any critical holes in the path (if they exist)

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.

    worldmodeling: |
      Evaluate whether the prediction correctly anticipates the key aspects of the next FrozenLake state.
      Answer YES if the prediction accounts for directional relationships and potential holes, or NO if it contains errors.

      # Context
      You are evaluating whether the prediction correctly identifies:
      1. The future position relationship between the player and the goal after the move
      2. Whether the planned movement path avoids holes or acknowledges the risk of falling

      # Important: The Prediction Comes First
      Remember: The Next State Prediction is made BEFORE the Groundtruth Next State exists. Your task is to check if the prediction correctly anticipated what actually happened.

      The prediction doesn't need to perfectly describe every aspect of the next state - it just needs to correctly anticipate the directional relationships (Up, Down, Left, Right) and address any dangers from holes.

      # How to interpret coordinates:
      - If comparing coordinates (row1, col1) and (row2, col2):
        - If row1 < row2: The first object is ABOVE the second object
        - If row1 > row2: The first object is BELOW the second object
        - If col1 < col2: The first object is to the LEFT of the second object
        - If col1 > col2: The first object is to the RIGHT of the second object
      
      Example:
      Groundtruth Next State Information: {'player_position': (3, 2), 'target_position': (3, 2), 'hole_positions': [(1, 2)], 'grid_size': (4, 4)}
      Next State Prediction: the player will move to the left or down.
      - <think>The prediction state does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'player_position': (2, 1), 'target_position': (2, 1), 'hole_positions': [(1, 2), (2, 2)], 'grid_size': (4, 4)}
      Next State Prediction: The player will reach the target
      -  <think>The prediction state contains spatial relationship between player and target, do further analysis. According to the ground truth data, the player position is (2, 1) and the target position is (2, 1). Since 2 = 2 and 1 = 1, the player has already reached the target. The description states 'The player will reach down to the target' which acknowledges the 'down' direction and indicates reaching the target. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Next State Information: {'player_position': (0, 3), 'target_position': (0, 2), 'hole_positions': [(1, 1)], 'grid_size': (4, 4)}{'player_position': (0, 3), 'target_position': (1, 3), 'hole_positions': [(0, 3), (2, 3), (3, 1)], 'grid_size': (4, 4)}
      Next State Prediction: The player should move right first to avoid the frozen blocks and then move up to reach the goal.
      - <think>The prediction state does not contain spatial relationship between player and target.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'player_position': (2, 2), 'target_position': (1, 2), 'hole_positions': [(0, 3), (2, 0)], 'grid_size': (4, 4)}
      Next State Prediction: the player will reach the target
      - <think>The prediction state contains spatial relationship between player and target, do further analysis. According to the ground truth data, the player position is (2, 2) and the target position is (1, 2). Since 2 > 1, this indicates player is below the target. But description did not mention the spatial relationship of player and target. Thus, this is No. </think><answer>NO</answer>

      # Groundtruth Next State Information:
      {state_information_dict}

      # Next State Prediction:
      {natural_language_description}

      Think step by step:
      1. Player relationshpi with Goal
        - If player is already at the goal position, the prediction is automatically correct (YES)
        - Goal (Target) MUST include in prediction state, without target the prediction is automatically wrong (NO)
        - If there is no direction between player and goal, like "player is right to the target", the prediction is automatically wrong (NO)
        - This takes highest priority over all other considerations

      2. Directional Correctness
        - Evaluate if the predicted movement direction aligns with the relative position between player and goal
        - For example, if player is left of goal, moving right is correct

      3. Simple Judgment Rule
        - If player at goal → YES
        - If direction aligns with needed movement → YES
        - Otherwise → NO

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.
  
  maniskill:
    grounding: |
      Compare the description of the current state with the groundtruth current state information.
      Answer YES if the description reasonably matches the current state information, or NO if it doesn't.

      # Context
      You are evaluating whether an agent's description accurately reflects the actual state. The description should capture the meaningful relationships and positions relevant for decision-making in the task.
      
      Important evaluation criteria:
      1. If the description includes coordinates, they don't need to be exact matches with the groundtruth
      2. For coordinate values, consider them correct if they are within these error tolerances:
        - For x and y coordinates: within ±10 units of groundtruth
        - For z coordinates: within ±10 units of groundtruth
      3. The overall spatial relationships and object identifications should be correct
      4. If the description includes a dict-formatted state information, that's good but not required

      Example:
      Groundtruth Current State Information: {'red_cube_position': (119, -58, 20), 'green_cube_position': (-77, 192, 20), 'purple_cube_position': (-46, 51, 20)}
      State Description: {'red_cube':(119,-58,20), 'green_cube':(-46,51,20), 'purple_cube':(-77,192,20)}
      - <think>According to the ground truth data, the red cube position is (119, -58, 20) and the described position is (119, -58, 20). Since 119 = 119, -58 = -58, and 20 = 20, the red cube position is exactly correct. The green cube position is (-77, 192, 20) and the described position is (-46, 51, 20). The difference in x-coordinate is |-46 - (-77)| = 31, the difference in y-coordinate is |51 - 192| = 141, and the difference in z-coordinate is |20 - 20| = 0. Since both x and y differences exceed the 10-unit threshold, the green cube position is incorrect. The purple cube position is (-46, 51, 20) and the described position is (-77, 192, 20). The differences also exceed the 10-unit threshold. It appears the positions for the green and purple cubes have been swapped in the description. Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'left_target_position': (80, -100, 0), 'right_target_position': (80, 100, 0), 'red_cube_position': (83, -102, 20), 'green_cube_position': (-47, 95, 20)}
      State Description: {'red_cube':(83,-102,20),'green_cube':(-47,95,20),'left_target':(80,-100,0),'right_target':(80,100,0)}
      - <think>According to the ground truth data, the red cube position is (83, -102, 20) and the described position is (83, -102, 20). Since 83 = 83, -102 = -102, and 20 = 20, the red cube position is exactly correct. The green cube position is (-47, 95, 20) and the described position is (-47, 95, 20). Since -47 = -47, 95 = 95, and 20 = 20, the green cube position is exactly correct. The left target position is (80, -100, 0) and the described position is (80, -100, 0). Since 80 = 80, -100 = -100, and 0 = 0, the left target position is exactly correct. The right target position is (80, 100, 0) and the described position is (80, 100, 0). Since 80 = 80, 100 = 100, and 0 = 0, the right target position is exactly correct. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Current State Information: {'red_cube_position': (-219, 87, 20), 'green_cube_position': (-87, 61, 20), 'purple_cube_position': (-94, 62, 60)}
      State Description: {'red_cube':(-219,87,20),'green_cube':(-87,61,20),'purple_cube':(-94,62,60)}
      - <think>According to the ground truth data, the red cube position is (-219, 87, 20) and the described position is (-219, 87, 20). Since -219 = -219, 87 = 87, and 20 = 20, the red cube position is exactly correct. The green cube position is (-87, 61, 20) and the described position is (-87, 61, 20). Since -87 = -87, 61 = 61, and 20 = 20, the green cube position is exactly correct. The purple cube position is (-94, 62, 60) and the described position is (-94, 62, 60). Since -94 = -94, 62 = 62, and 60 = 60, the purple cube position is exactly correct. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Current State Information: {'apple_position': (-456, -520, 38), 'drawer_position': (-500, -775, 200)}
      State Description: {'apple':(-456,-520,38),'drawer':(-500,-775,200)}
      - <think>According to the ground truth data, the apple position is (-456, -520, 38) and the described position is (-456, -520, 38). Since -456 = -456, -520 = -520, and 38 = 38, the apple position is exactly correct. The drawer position is (-500, -775, 200) and the described position is (-500, -775, 200). Since -500 = -500, -775 = -775, and 200 = 200, the drawer position is exactly correct. Therefore, this description is Yes.</think><answer>YES</answer>

      # Groundtruth Current State Information:
      {state_information_dict}

      # State Description:
      {natural_language_description}

      Think step by step:
      1. Identify the key objects and their positions in the groundtruth information
      2. Check if the description correctly identifies these objects
      3. For any coordinates mentioned, check if they are within the acceptable error range
      4. Determine if the overall spatial understanding is correct, even if specific numbers differ slightly
      5. If coordinates in the description differ from groundtruth but are within the error tolerance, consider them correct

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.

    worldmodeling: |
      Compare the prediction of the next state with the groundtruth next state information.
      Answer YES if the prediction reasonably matches the next state information, or NO if it doesn't.

      # Context
      You are evaluating whether an agent's prediction of the next state is accurate. The prediction should capture the meaningful changes and relationships that will result from the planned actions.
      
      # Important: The Prediction Comes First
      Remember: The Next State Prediction is made BEFORE the Groundtruth Next State exists. Your task is to check if the prediction correctly anticipated what actually happened.

      Important evaluation criteria:
      1. If the prediction includes coordinates, they don't need to be exact matches with the groundtruth
      2. For coordinate values, consider them correct if they are within these error tolerances:
        - For x and y coordinates: within ±10 units of groundtruth
        - For z coordinates: within ±10 units of groundtruth
      3. The overall predicted movements and resulting spatial relationships should be correct
      4. If the prediction includes a dict-formatted state information, that's good but not required

      Example:
      Groundtruth Next State Information: {'red_cube_position': (-1, -193, 20), 'green_cube_position': (-5, 151, 20)}
      Next State Prediction: {'red_cube':(-1,-193,20),'green_cube':(0,157,20)}
      - <think>According to the ground truth data, the red cube position is (-1, -193, 20) and the described position is (-1, -193, 20). Since -1 = -1, -193 = -193, and 20 = 20, the red cube position is exactly correct. The green cube position is (-5, 151, 20) and the described position is (0, 157, 20). The difference in x-coordinate is |0 - (-5)| = 5, the difference in y-coordinate is |157 - 151| = 6, and the difference in z-coordinate is |20 - 20| = 0. Since all differences are within 10 units, the green cube position is considered correct. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Next State Information: {'left_target_position': (80, -100, 0), 'right_target_position': (80, 100, 0), 'red_cube_position': (-57, 79, 20), 'green_cube_position': (83, 102, 20)}
      Next State Prediction: {'green_cube':(80,100,0)}
      - <think>According to the ground truth data, the red cube position is (-57, 79, 20) and there is no described position for the red cube. The green cube position is (83, 102, 20) and the described position is (80, 100, 0). The difference in x-coordinate is |80 - 83| = 3, the difference in y-coordinate is |100 - 102| = 2, and the difference in z-coordinate is |0 - 20| = 20. While the x and y differences are within 10 units, the z-coordinate difference exceeds the 10-unit threshold. Additionally, the description only mentions the green cube and completely omits information about the red cube. Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'red_cube_position': (-1, 97, 20), 'green_cube_position': (106, 195, 20)}
      Next State Prediction: {'red_cube':(0,96,20),'green_cube':(106,195,20)}
      - <think>According to the ground truth data, the red cube position is (-1, 97, 20) and the described position is (0, 96, 20). The difference in x-coordinate is |0 - (-1)| = 1, the difference in y-coordinate is |96 - 97| = 1, and the difference in z-coordinate is |20 - 20| = 0. Since all differences are within 10 units, the red cube position is considered correct. The green cube position is (106, 195, 20) and the described position is (106, 195, 20). Since 106 = 106, 195 = 195, and 20 = 20, the green cube position is exactly correct. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Next State Information: {'apple_position': (-504, -537, 36), 'drawer_position': (-500, -732, 200)}
      Next State Prediction: Apple is on the floor, drawer is open.
      -  <think>According to the ground truth data, the apple position is (-504, -537, 36) and the drawer position is (-500, -732, 200). The description states 'Apple is on the floor, drawer is open' but does not provide any coordinate information or spatial positioning for either object. Without specifying the position coordinates or relative spatial relationships, the description fails to provide the necessary positional information. Therefore, this description is No.</think><answer>NO</answer>

      # Groundtruth Next State Information:
      {state_information_dict}

      # Next State Prediction:
      {natural_language_description}

      Think step by step:
      1. Identify the key objects and their positions in the groundtruth next state information
      2. Check if the prediction correctly anticipates these object positions
      3. For any coordinates mentioned, check if they are within the acceptable error range
      4. Determine if the overall predicted movement and resulting state is correct, even if specific numbers differ slightly
      5. If coordinates in the prediction differ from groundtruth but are within the error tolerance, consider them correct

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.
  
  navigation:
    grounding: |
      Evaluate whether the description effectively communicates the spatial relationship between the agent and target object, even if the exact directional terms differ.
      Answer YES if the overall spatial understanding is correct, or NO if it fundamentally misunderstands the spatial layout.

      # Context
      You are evaluating whether the description effectively conveys where the target object is located relative to the agent. The exact directional terminology (left, right, ahead, etc.) may differ between the state information and the description, but the important factor is whether the description would lead to correct navigation.
      
      # Key evaluation principle:
      Even if the directional terms don't exactly match (e.g., state says "ahead" but description says "left"), consider the description CORRECT if:
      1. It describes other landmarks or objects that are in the same general direction as the target
      2. It correctly describes the relative positions between multiple objects, showing spatial awareness
      3. It would still lead to appropriate navigation actions to reach the target
      
      Example:
      Groundtruth Current State Information: {'target_obj_type': 'Pot', 'target_obj_distance': 2.5325689964011757, 'distance_to_target': 2.53, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'Sink', 'distance': 1.11, 'relative_direction': 'left'}, {'type': 'SinkBasin', 'distance': 1.12, 'relative_direction': 'left'}, {'type': 'Tomato', 'distance': 1.16, 'relative_direction': 'left'}, {'type': 'Floor', 'distance': 1.25, 'relative_direction': 'left'}, {'type': 'Cabinet', 'distance': 1.28, 'relative_direction': 'ahead'}, {'type': 'CounterTop', 'distance': 1.29, 'relative_direction': 'ahead'}, {'type': 'Cabinet', 'distance': 1.31, 'relative_direction': 'ahead'}, {'type': 'Cabinet', 'distance': 1.35, 'relative_direction': 'ahead'}, {'type': 'Cabinet', 'distance': 1.38, 'relative_direction': 'ahead'}, {'type': 'Apple', 'distance': 1.42, 'relative_direction': 'ahead'}]}
      State Description: There is a red tomato on the left side of the sink, a red apple on the countertop, a plastic bag hanging on the left side, a kitchen sink, a kitchen counter with a knife, a knife holder, a small bowl on the counter, a pot on the right side of the counter, and a window above the counter.
      - <think>The state descirption does not contain spatial relationship between agent and pot.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'target_obj_type': 'DeskLamp', 'target_obj_distance': 1.7075852456479983, 'distance_to_target': 1.71, 'target_relative_direction': 'right', 'visible_objects': [{'type': 'Chair', 'distance': 1.08, 'relative_direction': 'ahead'}, {'type': 'Laptop', 'distance': 1.19, 'relative_direction': 'ahead'}, {'type': 'Desk', 'distance': 1.3, 'relative_direction': 'ahead'}, {'type': 'CellPhone', 'distance': 1.32, 'relative_direction': 'ahead'}, {'type': 'Drawer', 'distance': 1.34, 'relative_direction': 'right'}, {'type': 'Drawer', 'distance': 1.34, 'relative_direction': 'right'}, {'type': 'Blinds', 'distance': 1.39, 'relative_direction': 'ahead'}, {'type': 'Window', 'distance': 1.39, 'relative_direction': 'ahead'}, {'type': 'Book', 'distance': 1.43, 'relative_direction': 'ahead'}, {'type': 'SideTable', 'distance': 1.45, 'relative_direction': 'right'}]}
      State Description: There is a lamp on the desk to the right of the computer monitor. The lamp is brighter and more prominent than the computer monitor.
      - <think>The state descirption does not contain spatial relationship between agent and lamp.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Current State Information: {'target_obj_type': 'Plate', 'target_obj_distance': 1.5649347237856164, 'distance_to_target': 1.56, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'Floor', 'distance': 0.54, 'relative_direction': 'left'}, {'type': 'Box', 'distance': 1.48, 'relative_direction': 'ahead'}, {'type': 'Plate', 'distance': 1.56, 'relative_direction': 'ahead'}, {'type': 'Vase', 'distance': 1.77, 'relative_direction': 'ahead'}, {'type': 'Chair', 'distance': 1.8, 'relative_direction': 'ahead'}, {'type': 'Chair', 'distance': 1.87, 'relative_direction': 'ahead'}, {'type': 'Vase', 'distance': 2.05, 'relative_direction': 'ahead'}, {'type': 'DiningTable', 'distance': 2.09, 'relative_direction': 'ahead'}, {'type': 'Window', 'distance': 2.2, 'relative_direction': 'ahead'}, {'type': 'Chair', 'distance': 2.5, 'relative_direction': 'ahead'}]}
      State Description: here is a flat dish on the table in the background. It is located slightly to the left and ahead of me.
      - <think>The state description contains spatial relationship between agent and plate (flat dish), do further analysis. According to the ground truth data, the plate is 1.56 meters in the 'ahead' direction. While the data only categorizes the direction as 'ahead,' the qualification 'slightly to the left and ahead' provides a more refined directional awareness that's consistent with the object's position. The description also accurately conveys that the plate is at an intermediate distance (not too far), which aligns with the 1.56-meter measurement. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Current State Information: {'target_obj_type': 'AlarmClock', 'target_obj_distance': 2.9999776181931646, 'distance_to_target': 3.0, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'Bed', 'distance': 1.58, 'relative_direction': 'right'}, {'type': 'Box', 'distance': 1.73, 'relative_direction': 'ahead'}, {'type': 'Book', 'distance': 2.45, 'relative_direction': 'ahead'}, {'type': 'Floor', 'distance': 2.58, 'relative_direction': 'ahead'}, {'type': 'Drawer', 'distance': 2.67, 'relative_direction': 'ahead'}, {'type': 'Drawer', 'distance': 2.67, 'relative_direction': 'ahead'}, {'type': 'SideTable', 'distance': 2.68, 'relative_direction': 'ahead'}, {'type': 'KeyChain', 'distance': 2.76, 'relative_direction': 'ahead'}, {'type': 'CellPhone', 'distance': 2.88, 'relative_direction': 'ahead'}, {'type': 'CD', 'distance': 2.9, 'relative_direction': 'ahead'}]}{'target_obj_type': 'GarbageCan', 'target_obj_distance': 2.9892238200204346, 'distance_to_target': 2.99, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'Drawer', 'distance': 1.34, 'relative_direction': 'ahead'}, {'type': 'Drawer', 'distance': 1.34, 'relative_direction': 'ahead'}, {'type': 'Drawer', 'distance': 1.34, 'relative_direction': 'ahead'}, {'type': 'CoffeeTable', 'distance': 1.52, 'relative_direction': 'right'}, {'type': 'Sofa', 'distance': 1.57, 'relative_direction': 'left'}, {'type': 'Floor', 'distance': 1.61, 'relative_direction': 'right'}, {'type': 'Laptop', 'distance': 1.61, 'relative_direction': 'right'}, {'type': 'Sofa', 'distance': 2.61, 'relative_direction': 'right'}, {'type': 'Newspaper', 'distance': 2.65, 'relative_direction': 'ahead'}, {'type': 'ArmChair', 'distance': 2.79, 'relative_direction': 'ahead'}]}
      State Description: There is a trash can in the room. To move to the trash can, I should first move forward.
      - <think>The state description contains spatial relationship between agent and garbage can, do further analysis. According to the ground truth data, the GarbageCan is 2.99 meters in the 'ahead' direction. While the description doesn't provide extensive detail about the exact location, the instruction to 'move forward' accurately indicates that the trash can is positioned ahead of the agent, which matches the ground truth data. Therefore, this is Yes </think><answer>YES</answer>


      # Groundtruth Current State Information:
      {state_information_dict}

      # State Description:
      {natural_language_description}

      Think step by step:
      1. First, check if the prediction explicitly uses EXACT directional terms that appear in the groundtruth state: "ahead", "left", "right", "up", "down". 
        - Terms like "move towards", "closer to", "near", "approaching", "in front of", "by", "at" DO NOT qualify
        - "Will be on the left/right/ahead" or "Will move left/right/forward" DO qualify
        - If no exact directional match to groundtruth is present, conclude with NO immediately
      2. If explicit direction words exist, verify that they EXACTLY match the target object's direction in the groundtruth:
        - If target is "ahead", prediction must specify "ahead", "forward", or "straight"
        - If target is "right", prediction must specify "right" 
        - If target is "left", prediction must specify "left"
      3. Even if the prediction mentions intermediate objects correctly, it MUST explicitly state the correct final direction to the target object
      4. The prediction cannot substitute object references for directions (saying "move to X" instead of "move right")
      5. Remember that the prediction was made BEFORE the groundtruth state was determined

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.

    worldmodeling: |
      Evaluate whether the prediction effectively anticipates how the agent would navigate toward the target object, even if the exact directional terms differ.
      Answer YES if the overall navigation plan is reasonable, or NO if it fundamentally misunderstands the spatial layout.

      # Context
      You are evaluating whether the prediction effectively anticipates how the agent would move to reach the target object. The exact directional terminology (left, right, ahead, etc.) may differ between the state information and the prediction, but the important factor is whether the prediction would lead to successful navigation.

      # Important: The Prediction Comes First
      Remember: The Next State Prediction is made BEFORE the Groundtruth Next State exists. Your task is to check if the prediction correctly anticipated what actually happened.

      # Key evaluation principle:
      Even if the directional terms don't exactly match (e.g., state says "ahead" but prediction says "left"), consider the prediction CORRECT if:
      1. It describes a movement path that would generally lead toward the target
      2. It correctly anticipates how landmarks or objects would be positioned after movement
      3. The overall navigation strategy would plausibly succeed in reaching the target

      Example:
      Groundtruth Current State Information: {'target_obj_type': 'GarbageCan', 'target_obj_distance': 2.783293610228908, 'distance_to_target': 2.78, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'CellPhone', 'distance': 0.97, 'relative_direction': 'right'}, {'type': 'Chair', 'distance': 0.97, 'relative_direction': 'ahead'}, {'type': 'Plate', 'distance': 1.22, 'relative_direction': 'ahead'}, {'type': 'DiningTable', 'distance': 1.53, 'relative_direction': 'right'}, {'type': 'Chair', 'distance': 1.6, 'relative_direction': 'ahead'}, {'type': 'Floor', 'distance': 1.6, 'relative_direction': 'back'}, {'type': 'Chair', 'distance': 2.04, 'relative_direction': 'right'}, {'type': 'GarbageCan', 'distance': 2.78, 'relative_direction': 'ahead'}]}
      State Description: There is a trash can in the lower left corner of the image. To move there, I can go forward-left.
      - <think>The prediction state contains spatial relationship between agent and trash can, do further analysis. According to the ground truth data, the GarbageCan is 2.78 meters in the 'ahead' direction. The description places it in the 'lower left corner' and suggests 'forward-left' movement. Given that all visible objects are categorized only as 'ahead' or 'right', this 'forward-left' specification provides a more refined directional awareness within the limited vocabulary of the data. Therefore, this description is Yes.</think><answer>YES</answer>

      Example:
      Groundtruth Current State Information: {'target_obj_type': 'Book', 'target_obj_distance': 2.530649607411432, 'distance_to_target': 2.53, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'Laptop', 'distance': 1.14, 'relative_direction': 'ahead'}, {'type': 'Floor', 'distance': 1.4, 'relative_direction': 'right'}, {'type': 'CreditCard', 'distance': 1.53, 'relative_direction': 'ahead'}, {'type': 'Desk', 'distance': 1.79, 'relative_direction': 'ahead'}, {'type': 'Chair', 'distance': 1.9, 'relative_direction': 'ahead'}, {'type': 'Desktop', 'distance': 1.99, 'relative_direction': 'ahead'}, {'type': 'Bowl', 'distance': 2.32, 'relative_direction': 'ahead'}, {'type': 'Book', 'distance': 2.53, 'relative_direction': 'ahead'}, {'type': 'Box', 'distance': 2.58, 'relative_direction': 'ahead'}, {'type': 'Pencil', 'distance': 2.58, 'relative_direction': 'ahead'}]}
      State Description: I will move towards the table to reach the bound collection of pages.
      - <think>The prediction state does not contain spatial relationship between agent and book (pages).  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'target_obj_type': 'Lettuce', 'target_obj_distance': 1.4961137862340221, 'distance_to_target': 1.5, 'target_relative_direction': 'left', 'visible_objects': [{'type': 'Knife', 'distance': 0.8, 'relative_direction': 'ahead'}, {'type': 'SaltShaker', 'distance': 0.82, 'relative_direction': 'ahead'}, {'type': 'GarbageCan', 'distance': 0.85, 'relative_direction': 'ahead'}, {'type': 'Spatula', 'distance': 0.91, 'relative_direction': 'ahead'}, {'type': 'CounterTop', 'distance': 1.04, 'relative_direction': 'ahead'}, {'type': 'Toaster', 'distance': 1.11, 'relative_direction': 'ahead'}, {'type': 'CoffeeMachine', 'distance': 1.12, 'relative_direction': 'ahead'}, {'type': 'Mug', 'distance': 1.14, 'relative_direction': 'right'}, {'type': 'PepperShaker', 'distance': 1.21, 'relative_direction': 'ahead'}, {'type': 'DiningTable', 'distance': 1.4, 'relative_direction': 'right'}]}
      Next State Prediction: I will be close to the lettuce.
      - <think>The prediction state does not contain spatial relationship between agent and lettuce.  Therefore, this description is No.</think><answer>NO</answer>

      Example:
      Groundtruth Next State Information: {'target_obj_type': 'DeskLamp', 'target_obj_distance': 2.6981302750932072, 'distance_to_target': 2.7, 'target_relative_direction': 'ahead', 'visible_objects': [{'type': 'Curtains', 'distance': 1.72, 'relative_direction': 'left'}, {'type': 'KeyChain', 'distance': 2.25, 'relative_direction': 'ahead'}, {'type': 'Window', 'distance': 2.33, 'relative_direction': 'left'}, {'type': 'Pillow', 'distance': 2.44, 'relative_direction': 'ahead'}, {'type': 'Sofa', 'distance': 2.5, 'relative_direction': 'ahead'}, {'type': 'Shelf', 'distance': 2.51, 'relative_direction': 'ahead'}, {'type': 'SideTable', 'distance': 2.51, 'relative_direction': 'ahead'}, {'type': 'DeskLamp', 'distance': 2.7, 'relative_direction': 'ahead'}, {'type': 'Curtains', 'distance': 3.1, 'relative_direction': 'ahead'}, {'type': 'Window', 'distance': 3.11, 'relative_direction': 'ahead'}]}
      Next State Prediction: I should move forward and slightly to the right to get closer to the desk lamp.
      - <think>The prediction state contains spatial relationship between agent and DeskLamp, do further analysis. According to the ground truth data, the DeskLamp is 2.7 meters in the 'ahead' direction. The description indicates movement 'forward and slightly to the right' is needed to reach the lamp. While the directional data only categorizes positions as 'ahead' or 'left', the qualification 'slightly to the right' provides a more refined directional awareness within the limited vocabulary of the data. This shows accurate spatial understanding of the lamp's position. Therefore, this description is Yes.</think><answer>YES</answer>

      # Groundtruth Next State Information:
      {state_information_dict}

      # Next State Prediction:
      {natural_language_description}

      Think step by step:
      1. First, check if the prediction explicitly uses EXACT directional terms that appear in the groundtruth state: "ahead", "left", "right", "up", "down". 
        - Terms like "move towards", "closer to", "near", "approaching", "in front of", "by", "at" DO NOT qualify
        - "Will be on the left/right/ahead" or "Will move left/right/forward" DO qualify
        - If no exact directional match to groundtruth is present, conclude with NO immediately
      2. If explicit direction words exist, verify that they EXACTLY match the target object's direction in the groundtruth:
        - If target is "ahead", prediction must specify "ahead", "forward", "slightly left", OR "slightly right" (special case: we allow slightly left/right for ahead targets)
        - If target is "right", prediction must specify "right" 
        - If target is "left", prediction must specify "left"
      3. Even if the prediction mentions intermediate objects correctly, it MUST explicitly state the correct final direction to the target object
      4. The prediction cannot substitute object references for directions (saying "move to X" instead of "move right")
      5. Remember that the prediction was made BEFORE the groundtruth state was determined

      Your answer should be in the format of <think>...</think><answer>YES</answer> or <think>...</think><answer>NO</answer>.